<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistema Tutts v5.0</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes slideIn {
      from { transform: translateX(100%); opacity: 0; }
      to { transform: translateX(0); opacity: 1; }
    }
    .toast { animation: slideIn 0.3s ease-out; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  
  <script>
    const { useState, useEffect, createElement: h } = React;
    const API_URL = 'https://tutts-backend-production.up.railway.app/api';

    const Toast = ({ message, type }) => {
      const bgColor = type === 'success' ? 'bg-green-600' : 'bg-red-600';
      const icon = type === 'success' ? '‚úì' : '‚úó';
      return h('div', { 
        className: 'fixed top-4 right-4 z-50 px-6 py-4 rounded-lg shadow-2xl toast text-white font-semibold flex items-center gap-3 ' + bgColor 
      },
        h('span', { className: 'text-2xl' }, icon),
        h('span', null, message)
      );
    };

    const ImageModal = ({ imageUrl, onClose }) => h('div', { 
      className: 'fixed inset-0 bg-black bg-opacity-75 z-50 flex items-center justify-center p-4',
      onClick: onClose
    },
      h('div', { className: 'relative max-w-4xl max-h-screen' },
        h('button', { 
          onClick: onClose,
          className: 'absolute -top-10 right-0 text-white text-3xl hover:text-gray-300'
        }, '‚úï'),
        h('img', { 
          src: imageUrl,
          alt: 'Imagem expandida',
          className: 'max-w-full max-h-screen rounded-lg shadow-2xl',
          onClick: (e) => e.stopPropagation()
        })
      )
    );

    function App() {
      const [currentUser, setCurrentUser] = useState(null);
      const [page, setPage] = useState('login');
      const [toast, setToast] = useState(null);
      const [selectedImage, setSelectedImage] = useState(null);
      const [lastActivity, setLastActivity] = useState(Date.now());

      useEffect(() => {
        const token = localStorage.getItem('token');
        const user = localStorage.getItem('user');
        if (token && user) {
          const userData = JSON.parse(user);
          setCurrentUser(userData);
          setPage(userData.role === 'admin' ? 'form' : 'list');
        }
      }, []);

      useEffect(() => {
        if (!currentUser) return;
        
        const updateActivity = () => setLastActivity(Date.now());
        
        window.addEventListener('mousemove', updateActivity);
        window.addEventListener('keydown', updateActivity);
        window.addEventListener('click', updateActivity);
        window.addEventListener('scroll', updateActivity);
        
        const checkInactivity = setInterval(() => {
          const inactiveTime = Date.now() - lastActivity;
          if (inactiveTime >= 300000) {
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            setCurrentUser(null);
            setPage('login');
            showToast('Sess√£o expirada por inatividade', 'error');
          }
        }, 30000);
        
        return () => {
          window.removeEventListener('mousemove', updateActivity);
          window.removeEventListener('keydown', updateActivity);
          window.removeEventListener('click', updateActivity);
          window.removeEventListener('scroll', updateActivity);
          clearInterval(checkInactivity);
        };
      }, [currentUser, lastActivity]);

      const showToast = (message, type) => {
        if (!type) type = 'success';
        setToast({ message: message, type: type });
        setTimeout(() => setToast(null), 3000);
      };

      const handleLogout = () => {
        localStorage.removeItem('token');
        localStorage.removeItem('user');
        setCurrentUser(null);
        setPage('login');
        showToast('Logout realizado com sucesso!');
      };

      if (!currentUser) {
        return h(LoginPage, { 
          onLogin: (user) => {
            setCurrentUser(user);
            setPage(user.role === 'admin' ? 'form' : 'list');
            showToast('Bem-vindo, ' + user.username + '!');
          },
          showToast: showToast
        });
      }

      return h('div', null,
        toast && h(Toast, { message: toast.message, type: toast.type }),
        selectedImage && h(ImageModal, { imageUrl: selectedImage, onClose: () => setSelectedImage(null) }),
        h('div', { className: 'min-h-screen bg-gradient-to-br from-violet-50 to-blue-50' },
          h('nav', { className: 'bg-white shadow-lg border-b-4 border-violet-600' },
            h('div', { className: 'max-w-7xl mx-auto px-4 py-4 flex justify-between items-center' },
              h('h1', { className: 'text-3xl font-bold bg-gradient-to-r from-violet-600 to-blue-600 bg-clip-text text-transparent' }, 'üéØ Sistema Tutts'),
              h('div', { className: 'flex items-center gap-4' },
                h('span', { className: 'text-gray-700 font-medium' }, 'üë§ ' + currentUser.username),
                h('span', { className: 'px-3 py-1 rounded-full text-sm font-semibold ' + (currentUser.role === 'admin' ? 'bg-violet-100 text-violet-700' : 'bg-blue-100 text-blue-700') },
                  currentUser.role === 'admin' ? 'üîë Admin' : 'üëÅÔ∏è Visualizador'
                ),
                currentUser.role === 'admin' && h('div', { className: 'flex gap-2' },
                  h('button', {
                    onClick: () => setPage('form'),
                    className: 'px-4 py-2 rounded-lg font-semibold transition-all ' + (page === 'form' ? 'bg-violet-600 text-white shadow-lg' : 'bg-white text-violet-600 hover:bg-violet-50')
                  }, 'üìù Nova Solicita√ß√£o'),
                  h('button', {
                    onClick: () => setPage('list'),
                    className: 'px-4 py-2 rounded-lg font-semibold transition-all ' + (page === 'list' ? 'bg-violet-600 text-white shadow-lg' : 'bg-white text-violet-600 hover:bg-violet-50')
                  }, 'üìã Ver Solicita√ß√µes'),
                  h('button', {
                    onClick: () => setPage('create-admin'),
                    className: 'px-4 py-2 rounded-lg font-semibold transition-all ' + (page === 'create-admin' ? 'bg-violet-600 text-white shadow-lg' : 'bg-white text-violet-600 hover:bg-violet-50')
                  }, 'üë• Criar Admin')
                ),
                h('button', {
                  onClick: handleLogout,
                  className: 'px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-all font-semibold shadow-lg hover:shadow-xl'
                }, 'üö™ Sair')
              )
            )
          ),
          h('div', { className: 'max-w-7xl mx-auto px-4 py-8' },
            page === 'form' && h(FormPage, { showToast: showToast }),
            page === 'list' && h(ListPage, { currentUser: currentUser, showToast: showToast, onImageClick: setSelectedImage }),
            page === 'create-admin' && h(CreateAdminPage, { showToast: showToast })
          )
        )
      );
    }

    function LoginPage({ onLogin, showToast }) {
      const [username, setUsername] = useState('');
      const [password, setPassword] = useState('');
      const [loading, setLoading] = useState(false);

      const handleSubmit = async (e) => {
        e.preventDefault();
        setLoading(true);
        try {
          const response = await fetch(API_URL + '/login', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ username: username, password: password })
          });
          const data = await response.json();
          if (response.ok) {
            localStorage.setItem('token', data.token);
            localStorage.setItem('user', JSON.stringify(data.user));
            onLogin(data.user);
          } else {
            showToast(data.error || 'Erro ao fazer login', 'error');
          }
        } catch (error) {
          showToast('Erro ao conectar ao servidor', 'error');
        } finally {
          setLoading(false);
        }
      };

      return h('div', { className: 'min-h-screen bg-gradient-to-br from-violet-600 to-blue-600 flex items-center justify-center p-4' },
        h('div', { className: 'bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md' },
          h('div', { className: 'text-center mb-8' },
            h('h1', { className: 'text-4xl font-bold bg-gradient-to-r from-violet-600 to-blue-600 bg-clip-text text-transparent mb-2' }, 'üéØ Sistema Tutts'),
            h('p', { className: 'text-gray-600' }, 'Solicita√ß√µes de Ajustes')
          ),
          h('form', { onSubmit: handleSubmit, className: 'space-y-6' },
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Usu√°rio'),
              h('input', {
                type: 'text',
                value: username,
                onChange: (e) => setUsername(e.target.value),
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                required: true
              })
            ),
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Senha'),
              h('input', {
                type: 'password',
                value: password,
                onChange: (e) => setPassword(e.target.value),
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                required: true
              })
            ),
            h('button', {
              type: 'submit',
              disabled: loading,
              className: 'w-full bg-gradient-to-r from-violet-600 to-blue-600 text-white py-3 rounded-lg font-bold hover:shadow-xl transition-all disabled:opacity-50'
            }, loading ? '‚è≥ Entrando...' : 'üîê Entrar')
          )
        )
      );
    }

    function FormPage({ showToast }) {
      const [formData, setFormData] = useState({
        nomeTecnico: '',
        nomeCliente: '',
        motivoVisita: '',
        descricao: '',
        imagens: [],
        imagemComprovante: null
      });
      const [loading, setLoading] = useState(false);
      const [showValidation, setShowValidation] = useState(false);

      const motivos = [
        'Instala√ß√£o',
        'Manuten√ß√£o Preventiva',
        'Manuten√ß√£o Corretiva',
        'Ajuste de Ped√°gio (Campinas e Recife)',
        'Treinamento',
        'Outros'
      ];

      const compressImage = (file) => {
        return new Promise((resolve) => {
          const reader = new FileReader();
          reader.onload = (e) => {
            const img = new Image();
            img.onload = () => {
              const canvas = document.createElement('canvas');
              let width = img.width;
              let height = img.height;
              const maxDimension = 1200;
              if (width > height && width > maxDimension) {
                height = height * maxDimension / width;
                width = maxDimension;
              } else if (height > maxDimension) {
                width = width * maxDimension / height;
                height = maxDimension;
              }
              canvas.width = width;
              canvas.height = height;
              const ctx = canvas.getContext('2d');
              ctx.drawImage(img, 0, 0, width, height);
              let quality = 0.7;
              let compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
              while (compressedDataUrl.length > 512000 * 1.37 && quality > 0.1) {
                quality -= 0.1;
                compressedDataUrl = canvas.toDataURL('image/jpeg', quality);
              }
              resolve(compressedDataUrl);
            };
            img.src = e.target.result;
          };
          reader.readAsDataURL(file);
        });
      };

      const handleImageChange = async (e) => {
        const files = Array.from(e.target.files);
        if (files.length > 2) {
          showToast('M√°ximo de 2 fotos permitidas', 'error');
          e.target.value = '';
          return;
        }
        const compressed = await Promise.all(files.map(f => compressImage(f)));
        setFormData({ ...formData, imagens: compressed });
      };

      const handleComprovanteChange = async (e) => {
        const file = e.target.files[0];
        if (file) {
          const compressed = await compressImage(file);
          setFormData({ ...formData, imagemComprovante: compressed });
        }
      };

      const removeImage = (index) => {
        const newImages = formData.imagens.filter((img, i) => i !== index);
        setFormData({ ...formData, imagens: newImages });
      };

      const handleSubmit = async (e) => {
        e.preventDefault();
        setShowValidation(true);
        
        const isPedagio = formData.motivoVisita === 'Ajuste de Ped√°gio (Campinas e Recife)';
        if (isPedagio && formData.imagens.length === 0) {
          showToast('Foto obrigat√≥ria para Ajuste de Ped√°gio!', 'error');
          return;
        }

        setLoading(true);
        try {
          const token = localStorage.getItem('token');
          const response = await fetch(API_URL + '/submissions', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': 'Bearer ' + token
            },
            body: JSON.stringify({
              nomeTecnico: formData.nomeTecnico,
              nomeCliente: formData.nomeCliente,
              motivoVisita: formData.motivoVisita,
              descricao: formData.descricao,
              imagens: formData.imagens.join(','),
              imagemComprovante: formData.imagemComprovante
            })
          });
          if (response.ok) {
            showToast('Solicita√ß√£o enviada com sucesso!');
            setFormData({
              nomeTecnico: '',
              nomeCliente: '',
              motivoVisita: '',
              descricao: '',
              imagens: [],
              imagemComprovante: null
            });
            setShowValidation(false);
          } else {
            const data = await response.json();
            showToast(data.error || 'Erro ao enviar solicita√ß√£o', 'error');
          }
        } catch (error) {
          showToast('Erro ao conectar ao servidor', 'error');
        } finally {
          setLoading(false);
        }
      };

      const isPedagio = formData.motivoVisita === 'Ajuste de Ped√°gio (Campinas e Recife)';

      return h('div', { className: 'max-w-4xl mx-auto' },
        h('div', { className: 'bg-white rounded-2xl shadow-xl p-8' },
          h('h2', { className: 'text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3' },
            h('span', { className: 'text-4xl' }, 'üìù'),
            'Nova Solicita√ß√£o de Ajuste'
          ),
          h('form', { onSubmit: handleSubmit, className: 'space-y-6' },
            h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-6' },
              h('div', null,
                h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Nome do T√©cnico *'),
                h('input', {
                  type: 'text',
                  value: formData.nomeTecnico,
                  onChange: (e) => setFormData({ ...formData, nomeTecnico: e.target.value }),
                  className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                  required: true
                })
              ),
              h('div', null,
                h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Nome do Cliente *'),
                h('input', {
                  type: 'text',
                  value: formData.nomeCliente,
                  onChange: (e) => setFormData({ ...formData, nomeCliente: e.target.value }),
                  className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                  required: true
                })
              )
            ),
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Motivo da Visita *'),
              h('select', {
                value: formData.motivoVisita,
                onChange: (e) => setFormData({ ...formData, motivoVisita: e.target.value }),
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                required: true
              },
                h('option', { value: '' }, 'Selecione um motivo'),
                motivos.map(m => h('option', { key: m, value: m }, m))
              )
            ),
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Descri√ß√£o *'),
              h('textarea', {
                value: formData.descricao,
                onChange: (e) => setFormData({ ...formData, descricao: e.target.value }),
                rows: 4,
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                required: true
              })
            ),
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2 flex items-center gap-2' },
                'üì∏ Fotos da OS (m√°x. 2) ',
                isPedagio && h('span', { className: 'text-red-600' }, '*'),
                isPedagio && h('span', { className: 'text-red-600 text-sm font-normal' }, '(Obrigat√≥rio para Ped√°gio)')
              ),
              h('input', {
                type: 'file',
                accept: 'image/*',
                multiple: true,
                onChange: handleImageChange,
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all'
              }),
              showValidation && isPedagio && formData.imagens.length === 0 && h('p', { className: 'text-red-600 text-sm mt-2' }, '‚ö†Ô∏è Foto obrigat√≥ria para Ajuste de Ped√°gio!'),
              formData.imagens.length > 0 && h('div', { className: 'flex gap-4 mt-4' },
                formData.imagens.map((img, index) =>
                  h('div', { key: index, className: 'relative' },
                    h('img', { src: img, alt: 'Preview ' + (index + 1), className: 'w-32 h-32 object-cover rounded-lg border-2 border-gray-300' }),
                    h('button', {
                      type: 'button',
                      onClick: () => removeImage(index),
                      className: 'absolute -top-2 -right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-700 transition-all'
                    }, '‚úï')
                  )
                )
              )
            ),
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'üìÑ Comprovante de Deslocamento (opcional)'),
              h('input', {
                type: 'file',
                accept: 'image/*',
                onChange: handleComprovanteChange,
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all'
              }),
              formData.imagemComprovante && h('div', { className: 'mt-4 relative inline-block' },
                h('img', { src: formData.imagemComprovante, alt: 'Preview Comprovante', className: 'w-32 h-32 object-cover rounded-lg border-2 border-gray-300' }),
                h('button', {
                  type: 'button',
                  onClick: () => setFormData({ ...formData, imagemComprovante: null }),
                  className: 'absolute -top-2 -right-2 bg-red-600 text-white rounded-full w-6 h-6 flex items-center justify-center hover:bg-red-700 transition-all'
                }, '‚úï')
              )
            ),
            h('button', {
              type: 'submit',
              disabled: loading,
              className: 'w-full bg-gradient-to-r from-violet-600 to-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:shadow-xl transition-all disabled:opacity-50'
            }, loading ? '‚è≥ Enviando...' : '‚úÖ Enviar Solicita√ß√£o')
          )
        )
      );
    }

    function ListPage({ currentUser, showToast, onImageClick }) {
      const [submissions, setSubmissions] = useState([]);
      const [loading, setLoading] = useState(true);
      const [selectedMotivo, setSelectedMotivo] = useState('');

      const motivos = [
        'Instala√ß√£o',
        'Manuten√ß√£o Preventiva',
        'Manuten√ß√£o Corretiva',
        'Ajuste de Ped√°gio (Campinas e Recife)',
        'Treinamento',
        'Outros'
      ];

      useEffect(() => {
        fetchSubmissions();
        const interval = setInterval(() => {
          console.log('Auto-refresh: Atualizando lista');
          fetchSubmissions();
        }, 300000);
        return () => clearInterval(interval);
      }, []);

      const fetchSubmissions = async () => {
        try {
          const token = localStorage.getItem('token');
          const response = await fetch(API_URL + '/submissions', {
            headers: { 'Authorization': 'Bearer ' + token }
          });
          if (response.ok) {
            const data = await response.json();
            setSubmissions(data);
          }
        } catch (error) {
          showToast('Erro ao carregar solicita√ß√µes', 'error');
        } finally {
          setLoading(false);
        }
      };

      const handleDelete = async (id) => {
        if (!confirm('Tem certeza que deseja excluir esta solicita√ß√£o?')) return;
        try {
          const token = localStorage.getItem('token');
          const response = await fetch(API_URL + '/submissions/' + id, {
            method: 'DELETE',
            headers: { 'Authorization': 'Bearer ' + token }
          });
          if (response.ok) {
            showToast('Solicita√ß√£o exclu√≠da com sucesso!');
            fetchSubmissions();
          } else {
            showToast('Erro ao excluir solicita√ß√£o', 'error');
          }
        } catch (error) {
          showToast('Erro ao conectar ao servidor', 'error');
        }
      };

      const filteredSubmissions = selectedMotivo ? submissions.filter(s => s.motivo === selectedMotivo) : submissions;

      if (loading) {
        return h('div', { className: 'text-center text-2xl mt-20' }, '‚è≥ Carregando...');
      }

      return h('div', null,
        h('div', { className: 'mb-6 flex gap-4 items-center' },
          h('label', { className: 'text-gray-700 font-semibold' }, 'Filtrar por Motivo:'),
          h('select', {
            value: selectedMotivo,
            onChange: (e) => setSelectedMotivo(e.target.value),
            className: 'px-4 py-2 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none'
          },
            h('option', { value: '' }, 'Todos os motivos'),
            motivos.map(m => h('option', { key: m, value: m }, m))
          ),
          selectedMotivo && h('button', {
            onClick: () => setSelectedMotivo(''),
            className: 'px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300'
          }, '‚úï Limpar')
        ),
        h('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-6' },
          filteredSubmissions.map(s => {
            const imgs = s.imagens ? (typeof s.imagens === 'string' ? s.imagens.split(',').filter(img => img.trim()) : s.imagens) : [];
            return h('div', { key: s.id, className: 'bg-white rounded-xl shadow-lg p-6 hover:shadow-2xl transition-all' },
              h('div', { className: 'flex justify-between items-start mb-4' },
                h('div', null,
                  h('h3', { className: 'text-xl font-bold text-gray-800' }, s.nome_cliente),
                  h('p', { className: 'text-gray-600' }, 'üë§ ' + s.nome_tecnico)
                ),
                currentUser.role === 'admin' && h('button', {
                  onClick: () => handleDelete(s.id),
                  className: 'text-red-600 hover:text-red-800 font-bold text-xl',
                  title: 'Excluir'
                }, 'üóëÔ∏è')
              ),
              h('div', { className: 'space-y-2 text-sm' },
                h('p', null, h('span', { className: 'font-semibold' }, 'Motivo: '), s.motivo),
                h('p', null, h('span', { className: 'font-semibold' }, 'Descri√ß√£o: '), s.descricao),
                h('p', { className: 'text-gray-500 text-xs' }, new Date(s.created_at).toLocaleString('pt-BR'))
              ),
              imgs.length > 0 && h('div', { className: 'mt-4' },
                h('p', { className: 'font-semibold mb-2' }, 'üì∏ Fotos da OS:'),
                h('div', { className: 'flex gap-2' },
                  imgs.map((img, i) => h('img', {
                    key: i,
                    src: img.trim(),
                    alt: 'Foto ' + (i + 1),
                    className: 'w-20 h-20 object-cover rounded-lg border-2 border-gray-300 cursor-pointer hover:scale-110 transition-all',
                    onClick: () => onImageClick(img.trim())
                  }))
                )
              ),
              s.imagem_comprovante && h('div', { className: 'mt-4' },
                h('p', { className: 'font-semibold mb-2' }, 'üìÑ Comprovante:'),
                h('img', {
                  src: s.imagem_comprovante,
                  alt: 'Comprovante',
                  className: 'w-20 h-20 object-cover rounded-lg border-2 border-gray-300 cursor-pointer hover:scale-110 transition-all',
                  onClick: () => onImageClick(s.imagem_comprovante)
                })
              )
            );
          })
        ),
        filteredSubmissions.length === 0 && h('div', { className: 'text-center text-gray-500 text-xl mt-20' }, 'üì≠ Nenhuma solicita√ß√£o encontrada')
      );
    }

    function CreateAdminPage({ showToast }) {
      const [formData, setFormData] = useState({
        username: '',
        password: '',
        confirmPassword: ''
      });
      const [loading, setLoading] = useState(false);

      const handleSubmit = async (e) => {
        e.preventDefault();
        if (formData.password !== formData.confirmPassword) {
          showToast('As senhas n√£o coincidem!', 'error');
          return;
        }
        setLoading(true);
        try {
          const token = localStorage.getItem('token');
          const response = await fetch(API_URL + '/users', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
              'Authorization': 'Bearer ' + token
            },
            body: JSON.stringify({
              username: formData.username,
              password: formData.password,
              role: 'admin'
            })
          });
          if (response.ok) {
            showToast('Admin criado com sucesso!');
            setFormData({ username: '', password: '', confirmPassword: '' });
          } else {
            const data = await response.json();
            showToast(data.error || 'Erro ao criar admin', 'error');
          }
        } catch (error) {
          showToast('Erro ao conectar ao servidor', 'error');
        } finally {
          setLoading(false);
        }
      };

      return h('div', { className: 'max-w-2xl mx-auto' },
        h('div', { className: 'bg-white rounded-2xl shadow-xl p-8' },
          h('h2', { className: 'text-3xl font-bold text-gray-800 mb-6 flex items-center gap-3' },
            h('span', { className: 'text-4xl' }, 'üë•'),
            'Criar Novo Admin'
          ),
          h('form', { onSubmit: handleSubmit, className: 'space-y-6' },
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Nome de Usu√°rio *'),
              h('input', {
                type: 'text',
                value: formData.username,
                onChange: (e) => setFormData({ ...formData, username: e.target.value }),
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                required: true
              })
            ),
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Senha *'),
              h('input', {
                type: 'password',
                value: formData.password,
                onChange: (e) => setFormData({ ...formData, password: e.target.value }),
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                required: true
              })
            ),
            h('div', null,
              h('label', { className: 'block text-gray-700 font-semibold mb-2' }, 'Confirmar Senha *'),
              h('input', {
                type: 'password',
                value: formData.confirmPassword,
                onChange: (e) => setFormData({ ...formData, confirmPassword: e.target.value }),
                className: 'w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:border-violet-600 focus:outline-none transition-all',
                required: true
              })
            ),
            h('button', {
              type: 'submit',
              disabled: loading,
              className: 'w-full bg-gradient-to-r from-violet-600 to-blue-600 text-white py-4 rounded-lg font-bold text-lg hover:shadow-xl transition-all disabled:opacity-50'
            }, loading ? '‚è≥ Criando...' : '‚úÖ Criar Admin')
          )
        )
      );
    }

    ReactDOM.render(h(App), document.getElementById('root'));
  </script>
</body>
</html>
